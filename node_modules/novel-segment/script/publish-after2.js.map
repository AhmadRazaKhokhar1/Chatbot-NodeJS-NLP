{"version":3,"file":"publish-after2.js","sourceRoot":"","sources":["publish-after2.ts"],"names":[],"mappings":";AAAA;;GAEG;;;AAEH,6BAA8B;AAI9B,qCAAqC;AACrC,kCAAmC;AACnC,+EAA8C;AAC9C,+BAA4B;AAE5B,CAAC,KAAK,IAAI,EAAE;IAEX,IAAI,UAA6B,CAAC;IAClC,aAAa;IACb,UAAU,GAAG,gEAAa,mBAAmB,GAAC,CAAC;IAE/C,IAAI,OAAe,CAAC;IAEpB,aAAa;IACb,OAAO,GAAG,MAAM,0DAAO,WAAW,IAAE,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;IACtD,aAAa;IACb,OAAO,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC;IAE7B,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,wBAAa,CAAC,YAAY,CAAC,EAClE,CAAC;QACA,IAAI,SAAS,GAAG,MAAM,0DAAO,oBAAoB,IAC/C,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC;aACtB,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,CACjB;QAED,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,SAAS,CAAC,EACnD,CAAC;YACA,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;YAC9B,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;YACrC,OAAO,CAAC,IAAI,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;YACjC,OAAO,CAAC,IAAI,CAAC,eAAe,EAAE,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,wBAAa,CAAC,YAAY,CAAC,CAAC,CAAC;YAClF,OAAO;QACR,CAAC;IACF,CAAC;IAED,IAAI,GAAG,GAAG,IAAA,WAAI,EAAC,wBAAa,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;IAEnD,IAAI,OAAO,GAAG;QACb,GAAG;QACH,KAAK,EAAE,SAAS;KAChB,CAAC;IAEF,IAAI,GAAG,GAAG,iBAAiB,KAAK,CAAC,QAAQ,CAAC,eAAe,CAAC,kBAAkB,KAAK,CAAC,QAAQ,CAAC,cAAc,CAAC,cAAc,KAAK,CAAC,QAAQ,CAAC,UAAU,CAAC,gBAAgB,KAAK,CAAC,QAAQ,CAAC,YAAY,CAAC,EAAE,CAAC;IAEjM,MAAM,UAAU,CAAC,KAAK,EAAE;QACvB,QAAQ;QACR,OAAO;QACP,IAAI;QACJ,GAAG;QACH,GAAG;KACH,EAAE,OAAO,CAAC,CAAC;AAEb,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC","sourcesContent":["/**\n * Created by user on 2018/7/24/024.\n */\n\nimport path = require('path');\n// @ts-ignore\nimport PackageJson = require('../package.json');\nimport CrossSpawn = require('cross-spawn-extra');\n/// <reference types=\"cross-spawn\" />\nimport index = require('../index');\nimport ProjectConfig from '../project.config';\nimport { join } from \"path\";\n\n(async () =>\n{\n\tlet crossSpawn: typeof CrossSpawn;\n\t// @ts-ignore\n\tcrossSpawn = await import('cross-spawn-extra');\n\n\tlet gitroot: string;\n\n\t// @ts-ignore\n\tgitroot = await import('git-root2').then(m => m.sync);\n\t// @ts-ignore\n\tgitroot = gitroot(__dirname);\n\n\tif (!gitroot || path.relative(gitroot, ProjectConfig.project_root))\n\t{\n\t\tlet __root_ws = await import('../../../__root_ws')\n\t\t\t.then(m => m.__root_ws)\n\t\t\t.catch(e => null)\n\t\t;\n\n\t\tif (!__root_ws || path.relative(gitroot, __root_ws))\n\t\t{\n\t\t\tconsole.warn(`no git exists`);\n\t\t\tconsole.warn(`__root_ws`, __root_ws);\n\t\t\tconsole.warn(`gitroot`, gitroot);\n\t\t\tconsole.warn(`path.relative`, path.relative(gitroot, ProjectConfig.project_root));\n\t\t\treturn;\n\t\t}\n\t}\n\n\tlet cwd = join(ProjectConfig.project_root, 'test');\n\n\tlet options = {\n\t\tcwd,\n\t\tstdio: 'inherit',\n\t};\n\n\tlet msg = `novel-segment@${index.versions['novel-segment']}, segment-dict@${index.versions['segment-dict']}, cjk-conv@${index.versions['cjk-conv']}, regexp-cjk@${index.versions['regexp-cjk']}`;\n\n\tawait crossSpawn('git', [\n\t\t'commit',\n\t\t//'-a',\n\t\t'-m',\n\t\tmsg,\n\t\t'.',\n\t], options);\n\n})().catch(e => console.error(e));\n"]}
{"version":3,"file":"index.umd.development.cjs","sources":["../src/index.ts"],"sourcesContent":["export interface IOptions\n{\n  /**\n   * Set to `true` to compare strings case-insensitively. Default: `false`.\n   * @default false\n   */\n  caseInsensitive?: boolean,\n  /**\n   * A string of characters that define a custom character ordering. Default: `undefined`.\n   */\n  alphabet?: string,\n}\n\nexport type IAlphabetIndexMap = number[];\n\nconst alphabetIndexMapCache: Record<string, IAlphabetIndexMap> = {};\nconst defaultAlphabetIndexMap: IAlphabetIndexMap = [];\n\nexport function isNumberCode(code: number) {\n  return code >= 48/* '0' */ && code <= 57/* '9' */;\n}\n\nexport function naturalCompare(a: string, b: string, opts?: IOptions) {\n  const lengthA = _strLength(a, 'a');\n  const lengthB = _strLength(b, 'b');\n  let indexA = 0;\n  let indexB = 0;\n  let alphabetIndexMap = defaultAlphabetIndexMap;\n  let firstDifferenceInLeadingZeros = 0;\n\n  if (opts) {\n    if (opts.caseInsensitive) {\n      a = a.toLowerCase();\n      b = b.toLowerCase();\n    }\n\n    if (opts.alphabet) {\n      alphabetIndexMap = buildAlphabetIndexMap(opts.alphabet);\n    }\n  }\n\n  while (indexA < lengthA && indexB < lengthB) {\n    let charCodeA = a.charCodeAt(indexA);\n    let charCodeB = b.charCodeAt(indexB);\n    let difference: number;\n\n    if (isNumberCode(charCodeA)) {\n      if (!isNumberCode(charCodeB)) {\n        return charCodeA - charCodeB;\n      }\n\n      let numStartA = indexA;\n      let numStartB = indexB;\n\n      while (charCodeA === 48/* '0' */ && ++numStartA < lengthA) {\n        charCodeA = a.charCodeAt(numStartA);\n      }\n      while (charCodeB === 48/* '0' */ && ++numStartB < lengthB) {\n        charCodeB = b.charCodeAt(numStartB);\n      }\n\n      if (numStartA !== numStartB && firstDifferenceInLeadingZeros === 0) {\n        firstDifferenceInLeadingZeros = numStartA - numStartB;\n      }\n\n      let numEndA = _indexOfNumEnd(a, lengthA, numStartA);\n      let numEndB = _indexOfNumEnd(b, lengthB, numStartB);\n\n      difference = numEndA - numStartA - numEndB + numStartB; // numA length - numB length\n      if (difference !== 0) {\n        return difference;\n      }\n\n      while (numStartA < numEndA) {\n        difference = a.charCodeAt(numStartA++) - b.charCodeAt(numStartB++);\n        if (difference !== 0) {\n          return difference;\n        }\n      }\n\n      indexA = numEndA;\n      indexB = numEndB;\n      continue;\n    }\n\n    if (0 !== (difference = _alphabetCompare(charCodeA, charCodeB, alphabetIndexMap)))\n    {\n      return difference;\n    }\n\n    ++indexA;\n    ++indexB;\n  }\n\n  if (indexA < lengthA) { // `b` is a substring of `a`\n    return 1 as const;\n  }\n\n  if (indexB < lengthB) { // `a` is a substring of `b`\n    return -1 as const;\n  }\n\n  return firstDifferenceInLeadingZeros;\n}\n\nexport function buildAlphabetIndexMap(alphabet: string): IAlphabetIndexMap {\n  const existingMap = alphabetIndexMapCache[alphabet];\n  if (existingMap !== undefined) {\n    return existingMap;\n  }\n\n  const indexMap: IAlphabetIndexMap = [];\n  const maxCharCode = alphabet.split('').reduce((maxCode, char) => {\n    return Math.max(maxCode, char.charCodeAt(0));\n  }, 0);\n\n  for (let i = 0; i <= maxCharCode; i++) {\n    indexMap.push(-1);\n  }\n\n  for (let i = 0; i < alphabet.length; i++) {\n    indexMap[alphabet.charCodeAt(i)] = i;\n  }\n\n  return alphabetIndexMapCache[alphabet] = indexMap;\n}\n\nexport function _indexOfNumEnd(a: string, lengthA: number, numStartA: number)\n{\n  while (numStartA < lengthA && isNumberCode(a.charCodeAt(numStartA)))\n  {\n    ++numStartA;\n  }\n  return numStartA\n}\n\nexport function _alphabetCompare(charCodeA: number, charCodeB: number, alphabetIndexMap: IAlphabetIndexMap)\n{\n  if (charCodeA !== charCodeB) {\n    if (\n      charCodeA < alphabetIndexMap.length &&\n      charCodeB < alphabetIndexMap.length &&\n      alphabetIndexMap[charCodeA] !== -1 &&\n      alphabetIndexMap[charCodeB] !== -1\n    ) {\n      return alphabetIndexMap[charCodeA] - alphabetIndexMap[charCodeB];\n    }\n\n    return charCodeA - charCodeB;\n  }\n\n  return 0 as const\n}\n\nexport function _strLength(a: string, name: string)\n{\n  if (typeof a !== 'string')\n  {\n    throw new TypeError(`The ${name} argument must be a string. Received type '${typeof a}'`);\n  }\n\n  return a.length;\n}\n\nexport default naturalCompare;\n\n// @ts-ignore\nif (process.env.TSDX_FORMAT !== 'esm')\n{\n  Object.defineProperty(naturalCompare, \"__esModule\", { value: true });\n\n  Object.defineProperty(naturalCompare, 'naturalCompare', { value: naturalCompare });\n  Object.defineProperty(naturalCompare, 'default', { value: naturalCompare });\n\n  Object.defineProperty(naturalCompare, 'isNumberCode', { value: isNumberCode });\n  Object.defineProperty(naturalCompare, 'buildAlphabetIndexMap', { value: buildAlphabetIndexMap });\n\n  Object.defineProperty(naturalCompare, '_indexOfNumEnd', { value: _indexOfNumEnd });\n  Object.defineProperty(naturalCompare, '_alphabetCompare', { value: _alphabetCompare });\n  Object.defineProperty(naturalCompare, '_strLength', { value: _strLength });\n}\n"],"names":["alphabetIndexMapCache","defaultAlphabetIndexMap","isNumberCode","code","naturalCompare","a","b","opts","lengthA","_strLength","lengthB","indexA","indexB","alphabetIndexMap","firstDifferenceInLeadingZeros","caseInsensitive","toLowerCase","alphabet","buildAlphabetIndexMap","charCodeA","charCodeAt","charCodeB","difference","numStartA","numStartB","numEndA","_indexOfNumEnd","numEndB","_alphabetCompare","existingMap","undefined","indexMap","maxCharCode","split","reduce","maxCode","char","Math","max","i","push","length","name","TypeError","Object","defineProperty","value"],"mappings":"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"}
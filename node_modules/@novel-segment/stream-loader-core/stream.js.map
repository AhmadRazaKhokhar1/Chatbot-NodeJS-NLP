{"version":3,"file":"stream.js","sourceRoot":"","sources":["stream.ts"],"names":[],"mappings":";;;AAAA,iCAAgE;AAOhE,SAAgB,gBAAgB,CAAI,IAAY,EAAE,UAS9C,EAAE;IAGL,OAAO,CAAC,OAAO,GAAG,OAAO,CAAC,OAAO,IAAI,UAAU,GAAG,EAAE,GAAG,IAAI;QAE1D,aAAa;QACb,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,IAAI,EAAE,CAAC;IAC/B,CAAC,CAAC;IAEF,OAAO,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,IAAI,UAAU,IAAI;QAEhD,OAAO,IAAI,CAAC;IACb,CAAC,CAAC;IAEF,OAAO,CAAC,MAAM,GAAG,OAAO,CAAC,MAAM,IAAI,UAAU,IAAI;QAEhD,aAAa;QACb,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,IAAI,EAAE,CAAC;QAC9B,aAAa;QACb,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACvB,CAAC,CAAC;IAEF,IAAI,MAAM,GAA8B,IAAA,uBAAgB,EAAC,IAAI,EAAE,OAAO,CAAC,MAAM,EAAE;QAE9E,OAAO,EAAE,OAAO,CAAC,OAAO;QAExB,MAAM,EAAE,OAAO,CAAC,MAAM;QAEtB,OAAO;YAEN,IAAI,OAAO,CAAC,QAAQ,EACpB,CAAC;gBACA,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,EAAE,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAA;YACxD,CAAC;QACF,CAAC;KACD,CAAC,CAAC;IAEH,OAAO,MAAM,CAAC;AACf,CAAC;AA/CD,4CA+CC;AAED,kBAAe,gBAAgB,CAAC","sourcesContent":["import { createStreamLine, IStreamLineWithValue } from './line';\n\nexport interface ICallback<T>\n{\n\t(err: Error, data?: T, stream?: IStreamLineWithValue<T>): void\n}\n\nexport function createLoadStream<T>(file: string, options: {\n\n\tmapper?(line: string),\n\tondata?(data),\n\n\tcallback?: ICallback<T>,\n\n\tonready?(...argv),\n\n} = {}): IStreamLineWithValue<T>\n{\n\n\toptions.onready = options.onready || function (src, ...argv)\n\t{\n\t\t// @ts-ignore\n\t\tthis.value = this.value || [];\n\t};\n\n\toptions.mapper = options.mapper || function (data)\n\t{\n\t\treturn data;\n\t};\n\n\toptions.ondata = options.ondata || function (data)\n\t{\n\t\t// @ts-ignore\n\t\tthis.value = this.value || [];\n\t\t// @ts-ignore\n\t\tthis.value.push(data);\n\t};\n\n\tlet stream: IStreamLineWithValue<any> = createStreamLine(file, options.mapper, {\n\n\t\tonready: options.onready,\n\n\t\tondata: options.ondata,\n\n\t\tonclose()\n\t\t{\n\t\t\tif (options.callback)\n\t\t\t{\n\t\t\t\toptions.callback.call(this, null, stream.value, stream)\n\t\t\t}\n\t\t},\n\t});\n\n\treturn stream;\n}\n\nexport default createLoadStream;\n"]}
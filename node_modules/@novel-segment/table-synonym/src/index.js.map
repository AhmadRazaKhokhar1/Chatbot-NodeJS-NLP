{"version":3,"file":"index.js","sourceRoot":"","sources":["index.ts"],"names":[],"mappings":";AAAA;;GAEG;;;AAGH,4EAA2E;AAS3E;;;;;GAKG;AACH,MAAa,gBAAiB,SAAQ,2CAAqB;IAS1D,YAAY,OAAe,gBAAgB,CAAC,IAAI,EAAE,OAAkC,EAAE,GAAG,IAAI;QAE5F,KAAK,CAAC,IAAI,EAAE,OAAO,EAAE,GAAG,IAAI,CAAC,CAAA;IAC9B,CAAC;IAEQ,GAAG,CAAC,IAA4B,EAAE,UAAoB,EAAE,cAAwB;;;QAExF,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAC3C;YACC,MAAM,IAAI,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;SAC1C;QAED,MAAM,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC;QAEnC,IAAI,CAAC,CAAC,CAAC,MAAM,EACb;YACC,MAAM,IAAI,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC;SAC1C;QAED,MAAM,IAAI,GAAG,IAAI,CAAC;QAElB,YAAA,IAAI,CAAC,MAAM,EAAC,CAAC,wCAAD,CAAC,IAAM,EAAE,EAAC;QAEtB,cAAc,aAAd,cAAc,cAAd,cAAc,IAAd,cAAc,GAAK,IAAI,CAAC,OAAO,CAAC,cAAc,EAAC;QAC/C,UAAU,aAAV,UAAU,cAAV,UAAU,IAAV,UAAU,GAAK,MAAA,IAAI,CAAC,OAAO,CAAC,UAAU,mCAAI,IAAI,EAAC;QAE/C,IAAI,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,KAAK;YAE/B,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC;YAEpB,IAAI,CAAC,EAAE,CAAC,MAAM,EACd;gBACC,IAAI,KAAK,KAAK,CAAC,EACf;oBACC,MAAM,IAAI,SAAS,EAAE,CAAC;iBACtB;gBAED,OAAO;aACP;YAED,IAAI,CAAC,CAAC,cAAc,CAAC,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,IAAI,EAAE,IAAI,IAAI,CAAC,MAAM,CAAC,EAC7E;gBACC,OAAO;aACP;YAED,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YACxB,IAAI,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;YAEjB,oBAAoB;QACrB,CAAC,CAAC,CAAC;QAEH,OAAO,IAAI,CAAC;IACb,CAAC;CAED;AA/DD,4CA+DC;AAED,kBAAe,gBAAgB,CAAA","sourcesContent":["/**\n * Created by user on 2018/4/19/019.\n */\n\nimport { IDICT, IOptions } from '@novel-segment/table-core-abstract';\nimport { TableDictSynonymPanGu } from '@novel-segment/table-synonym-pangu';\nimport { ArrayTwoOrMore } from '@novel-segment/types';\n\nexport interface IOptionsTableDictSynonym extends IOptions\n{\n\tskipExists?: boolean\n\tforceOverwrite?: boolean\n}\n\n/**\n * 請注意 這與原版 node-segment 的格式不同\n *\n * 原版為一對一 => 錯字,正字\n * 這裡為一對多 並且順序與原版相反 => 正字,錯字,...以,分隔更多字\n */\nexport class TableDictSynonym extends TableDictSynonymPanGu\n{\n\tpublic declare options: IOptionsTableDictSynonym;\n\n\t/**\n\t * 緩存主KEY\n\t */\n\tpublic declare TABLE2: IDICT<string[]>;\n\n\tconstructor(type: string = TableDictSynonym.type, options?: IOptionsTableDictSynonym, ...argv)\n\t{\n\t\tsuper(type, options, ...argv)\n\t}\n\n\toverride add(data: ArrayTwoOrMore<string>, skipExists?: boolean, forceOverwrite?: boolean)\n\t{\n\t\tif (!Array.isArray(data) || data.length < 2)\n\t\t{\n\t\t\tthrow new TypeError(JSON.stringify(data));\n\t\t}\n\n\t\tconst w = this._trim(data.shift());\n\n\t\tif (!w.length)\n\t\t{\n\t\t\tthrow new TypeError(JSON.stringify(data));\n\t\t}\n\n\t\tconst self = this;\n\n\t\tself.TABLE2[w] ??= [];\n\n\t\tforceOverwrite ??= this.options.forceOverwrite;\n\t\tskipExists ??= this.options.skipExists ?? true;\n\n\t\tdata.forEach(function (bw, index)\n\t\t{\n\t\t\tbw = self._trim(bw);\n\n\t\t\tif (!bw.length)\n\t\t\t{\n\t\t\t\tif (index === 0)\n\t\t\t\t{\n\t\t\t\t\tthrow new TypeError();\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ((!forceOverwrite) && (skipExists && self.exists(bw) || bw in self.TABLE2))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tself.TABLE2[w].push(bw);\n\t\t\tself._add(bw, w);\n\n\t\t\t//skipExists = true;\n\t\t});\n\n\t\treturn this;\n\t}\n\n}\n\nexport default TableDictSynonym\n"]}
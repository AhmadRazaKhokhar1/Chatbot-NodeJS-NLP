{"version":3,"file":"publish-after.js","sourceRoot":"","sources":["publish-after.ts"],"names":[],"mappings":";AAAA;;GAEG;;;AAEH,wDAAwB;AACxB,qEAA+C;AAC/C,aAAa;AACb,yDAAwD;AACxD,aAAa;AACb,kEAAqC;AAErC,CAAC,KAAK,IAAI,EAAE;IAEX,MAAM,YAAY,GAAG,cAAI,CAAC,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;IAEhD,IAAI,OAAe,CAAC;IAEpB,aAAa;IACb,OAAO,GAAG,IAAA,cAAO,EAAC,SAAS,CAAC,CAAC;IAE7B,IAAI,CAAC,OAAO,IAAI,cAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,YAAY,CAAC,EACpD,CAAC;QACA,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;QAC9B,OAAO;IACR,CAAC;IAED,IAAI,OAAO,GAAG;QACb,GAAG,EAAE,YAAY;QACjB,KAAK,EAAE,SAAS;KAChB,CAAC;IAEF,IAAI,GAAG,GAAG,eAAe,WAAW,CAAC,OAAO,EAAE,CAAC;IAE/C,MAAM,IAAA,yBAAU,EAAC,KAAK,EAAE;QACvB,QAAQ;QACR,IAAI;QACJ,IAAI;QACJ,GAAG;KACH,EAAE,OAAO,CAAC,CAAC;IAEZ,MAAM,IAAI,OAAO,CAAC,UAAU,IAAI;QAE/B,UAAU,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC;IACvB,CAAC,CAAC,CAAC;IAEH,MAAM,IAAA,yBAAU,EAAC,KAAK,EAAE;QACvB,KAAK;QACL,IAAI;QACJ,WAAW,CAAC,OAAO;QACnB,IAAI;QACJ,GAAG;KACH,EAAE,OAAO,CAAC,CAAC;AAEb,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC","sourcesContent":["/**\n * Created by user on 2018/7/24/024.\n */\n\nimport path from 'path';\nimport * as PackageJson from '../package.json';\n// @ts-ignore\nimport { async as crossSpawn } from 'cross-spawn-extra';\n// @ts-ignore\nimport gitRoot from 'git-root2/core';\n\n(async () =>\n{\n\tconst project_root = path.join(__dirname, '..');\n\n\tlet gitroot: string;\n\n\t// @ts-ignore\n\tgitroot = gitRoot(__dirname);\n\n\tif (!gitroot || path.relative(gitroot, project_root))\n\t{\n\t\tconsole.warn(`no git exists`);\n\t\treturn;\n\t}\n\n\tlet options = {\n\t\tcwd: project_root,\n\t\tstdio: 'inherit',\n\t};\n\n\tlet msg = `npm publish ${PackageJson.version}`;\n\n\tawait crossSpawn('git', [\n\t\t'commit',\n\t\t'-a',\n\t\t'-m',\n\t\tmsg,\n\t], options);\n\n\tawait new Promise(function (done)\n\t{\n\t\tsetTimeout(done, 500);\n\t});\n\n\tawait crossSpawn('git', [\n\t\t'tag',\n\t\t'-a',\n\t\tPackageJson.version,\n\t\t'-m',\n\t\tmsg,\n\t], options);\n\n})().catch(e => console.error(e));\n"]}
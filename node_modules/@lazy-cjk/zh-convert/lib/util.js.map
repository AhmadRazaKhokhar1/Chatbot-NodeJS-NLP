{"version":3,"file":"util.js","sourceRoot":"","sources":["util.ts"],"names":[],"mappings":"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","sourcesContent":["import { IOptions } from './types';\nimport { SAFE_MODE_CHAR, defaultOptions, REGEXP_TEST } from './const';\n\nexport function getOptionsSkip(options: IOptions, skip = SAFE_MODE_CHAR)\n{\n\tif (!options.skip)\n\t{\n\t\toptions.skip = skip.slice();\n\t}\n\telse if (typeof options.skip == 'string')\n\t{\n\t\toptions.skip += skip.join('');\n\t}\n\telse if (Array.isArray(options.skip))\n\t{\n\t\toptions.skip = options.skip.slice().concat(skip);\n\t}\n\telse\n\t{\n\t\toptions.table = skip.reduce(function (a, b)\n\t\t{\n\t\t\ta[b] = b;\n\n\t\t\treturn a;\n\t\t}, Object.assign({}, options.table || {}));\n\t}\n\n\treturn options;\n}\n\nexport function getOptions(options: IOptions = {}, defaultOpts = defaultOptions, skip = SAFE_MODE_CHAR)\n{\n\toptions = Object.assign({}, defaultOpts, options);\n\n\tif (options.safe)\n\t{\n\t\toptions = getOptionsSkip(options, skip);\n\n\t\t//console.log(options);\n\t}\n\n\treturn options;\n}\n\nexport function _call(fn, text: string, options: IOptions = {}, ...argv)\n{\n\toptions = getOptions(options);\n\n\tif (options.skip || options.table || options.tableOnly)\n\t{\n\t\tlet { skip, table, tableOnly } = options;\n\t\tlet not_tableOnly = !tableOnly;\n\n\t\tif (tableOnly && !table)\n\t\t{\n\t\t\tthrow new Error(`table is ${table}`);\n\t\t}\n\n\t\treturn text.replace(REGEXP_TEST, function (text)\n\t\t{\n\t\t\tif (skip && skip.indexOf(text) !== -1)\n\t\t\t{\n\t\t\t\treturn text;\n\t\t\t}\n\t\t\telse if (table && typeof table == 'function')\n\t\t\t{\n\t\t\t\tlet ret = table(fn, text, options, ...argv);\n\n\t\t\t\tif (ret !== null && typeof ret != 'undefined')\n\t\t\t\t{\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (table && table[text])\n\t\t\t{\n\t\t\t\treturn table[text];\n\t\t\t}\n\t\t\telse if (not_tableOnly)\n\t\t\t{\n\t\t\t\treturn fn(text);\n\t\t\t}\n\n\t\t\treturn text;\n\t\t});\n\t}\n\n\treturn fn(text, options, ...argv);\n}\n"]}